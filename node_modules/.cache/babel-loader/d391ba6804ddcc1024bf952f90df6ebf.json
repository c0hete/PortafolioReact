{"ast":null,"code":"import _asyncToGenerator from\"C:/react-portfolio-website/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/react-portfolio-website/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\react-portfolio-website\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import{useRef,useState,useEffect}from'react';import{auth,storage,db}from'../../firebase';import{ref,uploadBytes,getDownloadURL}from'firebase/storage';import{addDoc}from'firebase/firestore';import{collection}from'firebase/firestore/lite';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Home=function Home(){var form=useRef();var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isMounted=_useState2[0],setIsMounted=_useState2[1];useEffect(function(){return function(){setIsMounted(false);};},[]);var submitPortfolio=function submitPortfolio(e){var _form$current$,_form$current$2,_form$current$3,_form$current$4;e.preventDefault();var name=(_form$current$=form.current[0])===null||_form$current$===void 0?void 0:_form$current$.value;var description=(_form$current$2=form.current[1])===null||_form$current$2===void 0?void 0:_form$current$2.value;var url=(_form$current$3=form.current[2])===null||_form$current$3===void 0?void 0:_form$current$3.value;var image=(_form$current$4=form.current[3])===null||_form$current$4===void 0?void 0:_form$current$4.files[0];var storageRef=ref(storage,\"portfolio/\".concat(image.name));uploadBytes(storageRef,image).then(function(snapshot){getDownloadURL(snapshot.ref).then(function(downloadUrl){if(isMounted){// Verificar si el componente todavía está montado antes de actualizar el estado\nsavePortfolio({name:name,description:description,url:url,image:downloadUrl});}},function(error){console.log(error);if(isMounted){savePortfolio({name:name,description:description,url:url,image:null});}});},function(error){console.log(error);if(isMounted){savePortfolio({name:name,description:description,url:url,image:null});}});};var savePortfolio=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(portfolio){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return addDoc(collection(db,'portfolio'),portfolio);case 3:if(isMounted){window.location.reload(false);}_context.next=9;break;case 6:_context.prev=6;_context.t0=_context[\"catch\"](0);alert('Failed to add portfolio');case 9:case\"end\":return _context.stop();}}},_callee,null,[[0,6]]);}));return function savePortfolio(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"dashboard\",children:/*#__PURE__*/_jsxs(\"form\",{ref:form,onSubmit:submitPortfolio,children:[/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Name\"})}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Description\"})}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Url\"})}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"file\",placeholder:\"Image\"})}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Submit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return auth.signOut();},children:\"Sign out\"})]})});};export default Home;","map":{"version":3,"sources":["C:/react-portfolio-website/src/components/Dashboard/home.js"],"names":["useRef","useState","useEffect","auth","storage","db","ref","uploadBytes","getDownloadURL","addDoc","collection","Home","form","isMounted","setIsMounted","submitPortfolio","e","preventDefault","name","current","value","description","url","image","files","storageRef","then","snapshot","downloadUrl","savePortfolio","error","console","log","portfolio","window","location","reload","alert","signOut"],"mappings":"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","sourcesContent":["import { useRef, useState, useEffect } from 'react';\r\nimport { auth, storage, db } from '../../firebase';\r\nimport { ref, uploadBytes, getDownloadURL } from 'firebase/storage';\r\nimport { addDoc } from 'firebase/firestore';\r\nimport { collection } from 'firebase/firestore/lite';\r\n\r\nconst Home = () => {\r\n    const form = useRef();\r\n    const [isMounted, setIsMounted] = useState(true);\r\n\r\n    useEffect(() => {\r\n        return () => {\r\n            setIsMounted(false);\r\n        };\r\n    }, []);\r\n\r\n    const submitPortfolio = (e) => {\r\n        e.preventDefault();\r\n        const name = form.current[0]?.value;\r\n        const description = form.current[1]?.value;\r\n        const url = form.current[2]?.value;\r\n        const image = form.current[3]?.files[0];\r\n\r\n        const storageRef = ref(storage, `portfolio/${image.name}`);\r\n\r\n        uploadBytes(storageRef, image).then(\r\n            (snapshot) => {\r\n                getDownloadURL(snapshot.ref).then((downloadUrl) => {\r\n                    if (isMounted) { // Verificar si el componente todavía está montado antes de actualizar el estado\r\n                        savePortfolio({\r\n                            name,\r\n                            description,\r\n                            url,\r\n                            image: downloadUrl\r\n                        });\r\n                    }\r\n                }, (error) => {\r\n                    console.log(error);\r\n                    if (isMounted) {\r\n                        savePortfolio({\r\n                            name,\r\n                            description,\r\n                            url,\r\n                            image: null\r\n                        });\r\n                    }\r\n                });\r\n            }, (error) => {\r\n                console.log(error);\r\n                if (isMounted) {\r\n                    savePortfolio({\r\n                        name,\r\n                        description,\r\n                        url,\r\n                        image: null\r\n                    });\r\n                }\r\n            }\r\n        );\r\n    };\r\n\r\n    const savePortfolio = async (portfolio) => {\r\n        try {\r\n            await addDoc(collection(db, 'portfolio'), portfolio);\r\n            if (isMounted) {\r\n                window.location.reload(false);\r\n            }\r\n        } catch (error) {\r\n            alert('Failed to add portfolio');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"dashboard\">\r\n            <form ref={form} onSubmit={submitPortfolio}>\r\n                <p><input type=\"text\" placeholder=\"Name\" /></p>\r\n                <p><textarea placeholder=\"Description\" /></p>\r\n                <p><input type=\"text\" placeholder=\"Url\" /></p>\r\n                <p><input type=\"file\" placeholder=\"Image\" /></p>\r\n                <button type=\"submit\">Submit</button>\r\n                <button onClick={() => auth.signOut()}>Sign out</button>\r\n            </form>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Home;\r\n"]},"metadata":{},"sourceType":"module"}